<!doctype html>
<html>
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>HTTP API | Webstrates</title>
	<meta name="description" content="A research prototype enabling collaborative editing of websites through DOM manipulations.">
	<link rel="stylesheet" href="/css/syntax.css">
	<link rel="stylesheet" href="/css/main.css">
</head>
<body>
	<div id="container">
		<header>
			<h1>
				<a class="brand" href="/">Webstrates</a>
				<small>A research prototype enabling collaborative editing of websites through DOM manipulations.</small>
			</h1>
		</header>
		<main>
			<div id="navigation">
				<ul class="nav nav-list">
					<li class="home"><a href="/">Home</a></li>
					<li>
						<a class="nav-header" href="">Getting started</a>
						<ul>
							<!--li><a href="/gettingstarted/motivation.html">Motivation</a></li-->
							<li><a href="/gettingstarted/installation.html">Installation</a></li>
							<li><a href="/gettingstarted/hello-world.html">Hello, world</a></li>
							<li><a href="/userguide/tutorials.html">Tutorials</a></li>
						</ul>
					</li>
					<li>
						<a class="nav-header" href="">User guide</a>
						<ul>
							<li><a href="/userguide/api.html">API</a></li>
							<li>
								<ul>
									<li><a href="/userguide/api/events.html">Events</a></li>
									<li><a href="/userguide/api/transient.html">Transient</a></li>
									<li><a href="/userguide/api/cookies.html">Cookies</a></li>
									<li><a href="/userguide/api/assets.html">Assets</a></li>
									<li><a href="/userguide/api/signaling.html">Signaling</a></li>
									<li><a href="/userguide/api/messaging.html">Messaging</a></li>
									<li><a href="/userguide/api/tagging.html">Tagging</a></li>
									<li><a href="/userguide/api/access-tokens.html">Access Tokens</a></li>
									<li><a href="/userguide/api/restore-delete.html">Restore/Delete</a></li>
								</ul>
							</li>
							<li><a class="active" href="/userguide/http-api.html">HTTP API</a></li>
							<li><a href="/userguide/server-config.html">Server Config</a></li>
							<li><a href="/userguide/client-config.html">Client Config</a></li>
							<li><a href="/userguide/versioning.html">Versioning</a></li>
						</ul>
					</li>
					<li>
						<a class="nav-header" href="">Developer guide</a>
						<ul>
							<li><a href="/developerguide/introduction.html">Introduction</a></li>
							<li><a href="/developerguide/how-it-works.html">How it works</a></li>
							<li><a href="/developerguide/creating-a-module.html">Creating a module</a></li>
						</ul>
					</li>
				</ul>
			</div>
			<div id="content">
				<div class="page-header">
					<h1>HTTP API
						
					</h1>
				</div>
				<ul id="markdown-toc">
  <li><a href="#creation-of-webstrates" id="markdown-toc-creation-of-webstrates">Creation of webstrates</a></li>
  <li><a href="#accessing-the-history-of-a-webstrate" id="markdown-toc-accessing-the-history-of-a-webstrate">Accessing the history of a webstrate</a></li>
  <li><a href="#assets" id="markdown-toc-assets">Assets</a></li>
  <li><a href="#access-tokens" id="markdown-toc-access-tokens">Access tokens</a></li>
  <li><a href="#restoring-a-webstrate" id="markdown-toc-restoring-a-webstrate">Restoring a webstrate</a></li>
  <li><a href="#deleting-a-webstrate" id="markdown-toc-deleting-a-webstrate">Deleting a webstrate</a></li>
</ul>

<p>The <em>HTTP API</em> is the collective name for all Webstrates operations that can be performed with HTTP
GET requests. These operations allow the user to create and copy webstrates, access the history of a
webstrate, as well as the webstrate’s meta data, such as assets, tags and operations history.</p>

<h2 id="creation-of-webstrates">Creation of webstrates</h2>

<ul>
  <li>GET on <code class="highlighter-rouge">http://&lt;hostname&gt;/&lt;webstrateId&gt;/?copy</code> will create a new webstrate with a random id using
the webstrate <code class="highlighter-rouge">&lt;webstrateId&gt;</code> as a prototype (i.e. copying over the webstrate).</li>
  <li>GET on <code class="highlighter-rouge">http://&lt;hostname&gt;/&lt;webstrateId&gt;?copy=&lt;newWebstrateId&gt;</code> will create a new webstrate with id
<code class="highlighter-rouge">&lt;newWebstrateId&gt;</code> using the webstrate <code class="highlighter-rouge">&lt;webstrateId&gt;</code> as prototype.</li>
  <li>GET on <code class="highlighter-rouge">http://&lt;hostname&gt;/&lt;webstrateId&gt;/&lt;versionOrTag&gt;/?copy=&lt;newWebstrateId&gt;</code> will create a new
webstrate with id <code class="highlighter-rouge">&lt;newWebstrateId&gt;</code> using version or tag <code class="highlighter-rouge">&lt;versionOrTag&gt;</code> of the webstrate
<code class="highlighter-rouge">&lt;webstrateId&gt;</code> as prototype. If the <code class="highlighter-rouge">?copy</code> value is left out, a random id will be generated.</li>
  <li>GET on <code class="highlighter-rouge">http://&lt;hostname&gt;/new?prototypeUrl=&lt;someURL&gt;&amp;id=&lt;newWebstrateId&gt;</code> will create a new
webstrate (either with a random id or <code class="highlighter-rouge">&lt;nweWebstrateId&gt;</code> if provided), containing the contents of
<code class="highlighter-rouge">&lt;someURL&gt;</code>. <code class="highlighter-rouge">&lt;someURL&gt;</code> must be a fully qualified URL.</li>
</ul>

<p>When using <code class="highlighter-rouge">prototypeUrl</code>, it is the <em>source code</em> returned from the server that is being copied,
not the DOM. Therefore, when naively prototyping from another Webstrates server, the resulting
webstrate created would contain the Webstrates server’s <code class="highlighter-rouge">client.html</code>, not the actual webstrate. To
overcome this, use the <code class="highlighter-rouge">?raw</code> parameter.</p>

<div class="info box">
	When copying a webstrate that the copier doesn't have
	<a href="/userguide/permissions">permissions</a> to modify (read), one of two things will happen:
	<ul>
		<li>If the user is logged in, the read-write permissions are added to the permissions list
		of the copied webstrate. Note that the original permissions persist in the copy.</li>
		<li>If the user isn't logged in, the permissions will be wiped from the webstrate, so the
		webstrate uses the <a href="/userguide/permissions#defaults">default permissions</a>.</li>
	</ul>
	Note that it's not possible to copy a webstrate in which the user doesn't have read permissions,
	either explicitly in the <code>data-auth</code>, or implicitly by falling back to default
	permissions.
</div>

<p><strong>Legacy operations</strong></p>

<p>The below operations are still supported, but may disappear at any time.</p>

<ul>
  <li>GET on <code class="highlighter-rouge">http://&lt;hostname&gt;/new?prototype=&lt;webstrateId&gt;</code> will create a new webstrate with a random
id using the webstrate <code class="highlighter-rouge">&lt;webstrateId&gt;</code> as prototype.</li>
  <li>GET on <code class="highlighter-rouge">http://&lt;hostname&gt;/new?prototype=&lt;webstrateId&gt;&amp;id=&lt;newWebstrateId&gt;</code> will create a new
webstrate with id <code class="highlighter-rouge">&lt;newWebstrateId&gt;</code> using the webstrate <code class="highlighter-rouge">&lt;webstrateId&gt;</code> as prototype.</li>
  <li>GET on <code class="highlighter-rouge">http://&lt;hostname&gt;/new?prototype=&lt;webstrateId&gt;&amp;v=&lt;version&gt;&amp;id=&lt;newWebstrateId&gt;</code> will create
a new webstrate with id <code class="highlighter-rouge">&lt;newWebstrateId&gt;</code> using version <code class="highlighter-rouge">&lt;version&gt;</code> of the webstrate
<code class="highlighter-rouge">&lt;webstrateId&gt;</code> as prototype. If the <code class="highlighter-rouge">?id</code> value is left out, a random id will be generated.</li>
</ul>

<h2 id="accessing-the-history-of-a-webstrate">Accessing the history of a webstrate</h2>

<ul>
  <li>GET on <code class="highlighter-rouge">http://&lt;hostname&gt;/&lt;webstrateId&gt;/?v</code> will return the version number of <code class="highlighter-rouge">&lt;webstrateId&gt;</code>.</li>
  <li>GET on <code class="highlighter-rouge">http://&lt;hostname&gt;/&lt;webstrateId&gt;?tags</code> will return a list of tags associated with
<code class="highlighter-rouge">&lt;webstrateId&gt;</code>.</li>
  <li>GET on <code class="highlighter-rouge">http://&lt;hostname&gt;/&lt;webstrateId&gt;?ops</code> will return a list of all operations applied to
<code class="highlighter-rouge">&lt;webstrateId&gt;</code> (Beware: this can be a huge list).</li>
  <li>GET on <code class="highlighter-rouge">http://&lt;hostname&gt;/&lt;webstrateId&gt;/?static</code> will return a static version of webstrate
<code class="highlighter-rouge">&lt;webstrateId&gt;</code>.</li>
</ul>

<div class="info box">
	<p>When accessing a `static` version of a document, Webstrates serves `client.html` as per usual,
	and the webstrate requested is also generated on the client similar to how it is done for normal
	requests. Any changes made to the webstrate, however, are not persisted or shared between clients.
	</p>
</div>

<ul>
  <li>GET on <code class="highlighter-rouge">http://&lt;hostname&gt;/&lt;webstrateId&gt;/&lt;versionOrTag&gt;/</code> will return a static version of webstrate
<code class="highlighter-rouge">&lt;webstrateId&gt;</code> at version or tag <code class="highlighter-rouge">&lt;versionOrTag&gt;</code>.</li>
  <li>GET on <code class="highlighter-rouge">http://&lt;hostname&gt;/&lt;webstrateId&gt;/?raw</code> will return a raw version of webstrate
<code class="highlighter-rouge">&lt;webstrateId&gt;</code>.</li>
</ul>

<div class="info box">
	<p>On normal requests, the Webstrates server serves a static <code>client.html</code> with
	JavaScripts that replace the DOM with the content of the webstrate.</p>

	<p>When using the <code>raw</code> parameter, the Webstrates server instead serves the raw HTML.
	No Webstrates JavaScript is executed on the client side, and no WebSocket connection is
	established. This also means that DOM elements do not have attached <code>webstrate</code>
	objects, and as a result you cannot listen for Webstrate events, etc.</p>
</div>

<ul>
  <li>GET on <code class="highlighter-rouge">http://&lt;hostname&gt;/&lt;webstrateId&gt;/&lt;versionOrTag&gt;/?raw</code> will return a raw version of webstrate
<code class="highlighter-rouge">&lt;webstrateId&gt;</code> at version or tag <code class="highlighter-rouge">&lt;versionOrTag&gt;</code>.</li>
  <li>GET on <code class="highlighter-rouge">http://&lt;hostname&gt;/&lt;webstrateId&gt;/?dl</code> will return a ZIP (or TAR with <code class="highlighter-rouge">?dl=tar</code>) archive of
webstrate <code class="highlighter-rouge">&lt;webstrateId&gt;</code>.</li>
  <li>GET on <code class="highlighter-rouge">http://&lt;hostname&gt;/&lt;webstrateId&gt;/&lt;versionOrTag&gt;/?dl</code> will return a ZIP (or TAR with
<code class="highlighter-rouge">?dl=tar</code>) archive of webstrate <code class="highlighter-rouge">&lt;webstrateId&gt;</code> at version or tag <code class="highlighter-rouge">&lt;versionOrTag&gt;</code>.</li>
</ul>

<h2 id="assets">Assets</h2>

<ul>
  <li>GET on <code class="highlighter-rouge">http://&lt;hostname&gt;/&lt;webstrateId&gt;?assets</code> will return a list of assets (uploaded files)
associated with <code class="highlighter-rouge">&lt;webstrateId&gt;</code>.</li>
</ul>

<p>Assets can be attached to a webstrate by performing a POST request with a file (or multiple files)
to the webstrate’s path.</p>

<p>Note that forms <em>must</em> have <code class="highlighter-rouge">enctype="multipart/form-data"</code> to be recognized by the Webstrates
server.</p>

<p>For more information on assets, see the <a href="/userguide/api/assets.html">Assets section</a>.</p>

<h2 id="access-tokens">Access tokens</h2>

<ul>
  <li>GET on <code class="highlighter-rouge">http://&lt;hostname&gt;/&lt;webstrateId&gt;/?tokens</code> will return a list of all active access tokens.</li>
</ul>

<p>The creation of access tokens is done by performing a POST request to the webstrate the access token
is needed for, containing a <code class="highlighter-rouge">token</code> field. The value of the token field will be used as the token
duration in seconds. If the value is not a positive integer, it defaults to 300 seconds.</p>

<p>For more information on access tokens, see the
<a href="/userguide/api/access-tokens.html">Access Tokens section</a>.</p>

<h2 id="restoring-a-webstrate">Restoring a webstrate</h2>

<ul>
  <li>GET on <code class="highlighter-rouge">http://&lt;hostname&gt;/&lt;webstrateId&gt;?restore=&lt;versionOrTag&gt;</code> restores the document to look like
it did in version or tag <code class="highlighter-rouge">&lt;versionOrTag&gt;</code> and redirects the user to <code class="highlighter-rouge">/&lt;webstrateId&gt;</code>. This will
apply operations on the current verison until the desired version is reached and will therefore not
break the operations log or remove from it, but only add additional operations.</li>
</ul>

<div class="info box">
	<p>A webstrate can also be restored using
		<code><a href="/userguide/api/restore">webstrate.restore()</a></code>.
	</p>
</div>

<h2 id="deleting-a-webstrate">Deleting a webstrate</h2>

<ul>
  <li>GET on <code class="highlighter-rouge">http://&lt;hostname&gt;/&lt;webstrateId&gt;?delete</code> will delete the document and redirect all
connected users to the server root. The webstrate data including operations history, tags, assets,
etc. will all be completely and unrecoverably deleted.</li>
</ul>



				<div>

					<div id="navigation"></div>
					<div id="disqus">
<div id="disqus_thread"></div>
<script type="text/javascript">
(function() {
	var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
	dsq.src = '//' + 'webstrates' + '.disqus.com/embed.js';
	(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);

	function waitForIframe(callback) {
		var iframe = 	document.querySelector('iframe[id^=dsq]');
		if (iframe) return callback(iframe);
		setTimeout(waitForIframe, 0, callback);
	}
	waitForIframe(function(iframe) {
		var scale = 0.88, width = 1/scale * 100, offset = (width - 100) / 2;
		iframe.setAttribute("style", `transform:scale(${scale});width:${width}%;margin-left:-${offset}%;`);
	});
})();
</script>
					</div>

				</div>


<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-104382751-1', 'auto');
ga('send', 'pageview');
</script>

			</div>
		</main>
		<footer>
			Documentation for <a href="https://github.com/Webstrates/Webstrates">Webstrates</a>
		</footer>
	</div>
</body>
</html>
